#!/bin/bash

CONFIG_PATH="/path/to/config/file"

case $1 in
	start)
		echo -e "\033[1m\033[33mLoading Caddy launch agent...\033[0m"
		launchctl load "$(eval echo "~")/Library/LaunchAgents/com.caddy.server.plist"
		echo -e "\033[1m\033[32mCaddy loaded and started.\033[0m"
		exit 0;
		;;
	
	stop)
		echo -e "\033[1m\033[33mUnloading Caddy Launch Agent...\033[0m"
		launchctl unload "$(eval echo "~")/Library/LaunchAgents/com.caddy.server.plist"
		echo -e "\033[1m\033[31mCaddy unloaded and halted.\033[0m"
		exit 0;
		;;

	reload)
		echo -e "\033[1m\033[33mReloading Caddy...\033[0m"
		/usr/local/bin/caddy reload --config "${CONFIG_PATH}"
		echo -e "\033[1m\033[34mCaddy reloaded.\033[0m"
		exit 0;
		;;

	restart)
		echo -e "\033[1m\033[33mRestarting Caddy...\033[0m"
		echo -e "\033[1m\033[33mStopping Caddy...\033[0m"
		launchctl unload "$(eval echo "~")/Library/LaunchAgents/com.caddy.server.plist"
		echo -e "\033[1m\033[31mCaddy stopped.\033[0m"
		echo -e "\033[1m\033[33mStarting Caddy...\033[0m"
		sleep 2
		launchctl load "$(eval echo "~")/Library/LaunchAgents/com.caddy.server.plist"
		echo -e "\033[1m\033[32mCaddy started.\033[0m"
		exit 0;
		;;

	*)
		echo "Unknown command. Use \"start\" \"stop\" \"reload\" or \"restart\"."
		exit 1;
		;;
esac